import{f as F,r as m,al as i,H as p,o as n,I as a,Q as u,V as z,c as k,K as _,a as d,P as g,a6 as K,O as y,u as P,M as b,n as Q}from"./@vue-_Q8M3GyZ.js";import{u as T,a as $}from"./vue-router-ffDWPyKt.js";import{_ as G}from"./index-V73uJnXy.js";const J={class:"video-item"},W={class:"check"},X={class:"cover"},Y={class:"video-info"},Z={class:"video-name"},ee={class:"play-info"},oe={class:"iconfont icon-play2"},se={class:"create-time"},te={class:"op-btns"},le={__name:"VideoSeriesEdit",emits:["reload"],setup(ae,{expose:C,emit:I}){const{proxy:r}=F(),S=T();$();const v=m({show:!1,title:"视频列表"}),c=m(0),s=m(1),l=m({videoIds:[]}),f=m(),D={seriesName:[{required:!0,message:"请输入名称"}]};C({show:(t={},e=0)=>{L(),c.value=e,e===0||e==1?s.value=1:e==2&&(s.value=2),v.value.show=!0,Q(()=>{f.value.resetFields(),l.value=Object.assign({},t),l.value.videoIds=[]})}});const N=I,R=()=>{v.value.show=!1},A=()=>{f.value.validate(async t=>{t&&(s.value=2)})},B=()=>{f.value.validate(async t=>{t&&(s.value=1)})},H=()=>{f.value.validate(async t=>{if(!t)return;const e=Object.assign({},l.value);if(e.videoIds.length==0&&s.value==2){r.Message.warning("请选择视频");return}e.videoIds=e.videoIds.join(","),await r.Request({url:c.value==2?r.Api.uHomeSeriesSaveSeriesVideo:r.Api.uHomeSeriesSaveVideoSeries,params:e})&&(r.Message.success("保存成功"),v.value.show=!1,N("reload"))})},V=m([]),L=async()=>{let t=await r.Request({url:r.Api.uHomeSeriesLoadAllVideo,params:{seriesId:S.params.seriesId}});t&&(V.value=t.data)};return(t,e)=>{const h=i("el-input"),x=i("el-form-item"),M=i("el-checkbox"),U=i("Cover"),j=i("el-checkbox-group"),q=i("el-scrollbar"),w=i("el-button"),E=i("el-form"),O=i("Dialog");return n(),p(O,{show:v.value.show,title:v.value.title,buttons:v.value.buttons,width:"500px",showCancel:!1,onClose:e[4]||(e[4]=o=>v.value.show=!1)},{default:a(()=>[u(E,{model:l.value,rules:D,ref_key:"formDataRef",ref:f,"label-width":"80px",onSubmit:e[3]||(e[3]=z(()=>{},["prevent"]))},{default:a(()=>[s.value==1?(n(),k(g,{key:0},[u(x,{label:"列表名称",prop:"seriesName"},{default:a(()=>[u(h,{clearable:"",placeholder:"请填写名称",modelValue:l.value.seriesName,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.seriesName=o),maxlength:100,"show-word-limit":""},null,8,["modelValue"])]),_:1}),u(x,{label:"列表简介",prop:""},{default:a(()=>[u(h,{clearable:"",placeholder:"请填写简介（选填）",type:"textarea",rows:5,maxlength:200,"show-word-limit":"",resize:"none",modelValue:l.value.seriesDescription,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.seriesDescription=o)},null,8,["modelValue"])]),_:1})],64)):_("",!0),s.value==2?(n(),p(q,{key:1,"max-height":"400px"},{default:a(()=>[u(j,{modelValue:l.value.videoIds,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.videoIds=o)},{default:a(()=>[(n(!0),k(g,null,K(V.value,o=>(n(),k("div",J,[d("div",W,[u(M,{value:o.videoId},null,8,["value"])]),d("div",X,[u(U,{source:o.videoCover},null,8,["source"])]),d("div",Y,[d("div",Z,y(o.videoName),1),d("div",ee,[d("div",oe,y(o.playCount),1),d("div",se,y(P(r).Utils.formatDate(o.createTime)),1)])])]))),256))]),_:1},8,["modelValue"])]),_:1})):_("",!0),d("div",te,[s.value==1||c.value==2?(n(),p(w,{key:0,link:"",onClick:R},{default:a(()=>e[5]||(e[5]=[b(" 取消 ",-1)])),_:1,__:[5]})):_("",!0),s.value==1&&c.value!=1?(n(),p(w,{key:1,type:"primary",onClick:A},{default:a(()=>e[6]||(e[6]=[b(" 下一步 ",-1)])),_:1,__:[6]})):_("",!0),s.value==2&&c.value!=2?(n(),p(w,{key:2,type:"primary",onClick:B},{default:a(()=>e[7]||(e[7]=[b(" 上一步 ",-1)])),_:1,__:[7]})):_("",!0),s.value==2||c.value==1?(n(),p(w,{key:3,type:"primary",onClick:H},{default:a(()=>e[8]||(e[8]=[b(" 确定 ",-1)])),_:1,__:[8]})):_("",!0)])]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])}}},de=G(le,[["__scopeId","data-v-66962941"]]);export{de as V};
