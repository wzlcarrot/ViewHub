import{u as C}from"./index-V73uJnXy.js";import{u as L,a as D}from"./vue-router-ffDWPyKt.js";import{f as V,r as c,i as f,al as v,c as h,o as M,Q as y,I as S}from"./@vue-_Q8M3GyZ.js";const x={class:"data-list"},j={__name:"VideoList",setup(N){const r=C(),{proxy:d}=V(),e=L();D();const n=r.categoryMap,l=c({}),_=(a,t)=>{const s=a&&n[a]?n[a].categoryId:"",i=t&&n[t]?n[t].categoryId:"";l.value={pCategoryId:s,categoryId:i}},u=c(!1),o=c({}),p=async()=>{const a={pageNo:o.value.pageNo,...l.value};u.value=!0;const t=await d.Request({url:d.Api.loadVideo,params:a});if(u.value=!1,!t)return;const s=o.value.list;o.value=Object.assign({},t.data),t.data.pageNo>1&&(o.value.list=s.concat(t.data.list))},m=()=>{_(e.params.pCategoryCode,e.params.categoryCode),p()},g=c(!1);return f(()=>e.params,(a,t)=>{if(a){if(!g.value)return;r.setCureentPCategory(e.params.pCategoryCode),m()}},{immediate:!0,deep:!0}),f(()=>r.categoryMap,(a,t)=>{!a||Object.keys(a).length===0||(g.value=!0,r.setCureentPCategory(e.params.pCategoryCode),m())},{immediate:!0,deep:!0}),(a,t)=>{const s=v("VideoItem"),i=v("DataLoadMoreList");return M(),h("div",x,[y(i,{dataSource:o.value,loading:u.value,onLoadData:p},{default:S(({data:I})=>[y(s,{data:I,marginTop:20,ref:"videoItemRef"},null,8,["data"])]),_:1},8,["dataSource","loading"])])}}};export{j as _};
