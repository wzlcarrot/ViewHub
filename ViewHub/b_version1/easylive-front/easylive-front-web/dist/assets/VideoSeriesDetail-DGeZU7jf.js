import{f as T,l as j,r as y,al as n,c as p,o as l,a as o,Q as r,H as F,K as C,M as v,I as d,u as f,O as m,P as V,a6 as G,J,V as N,R as K}from"./@vue-_Q8M3GyZ.js";import{V as O}from"./VideoSeriesEdit-DCI5TmCO.js";import{l as P}from"./vue-draggable-plus-Cyz2QREE.js";import{a as Q,u as z}from"./vue-router-ffDWPyKt.js";import{_ as W,a as X}from"./index-V73uJnXy.js";import"./pinia-CtRA5Bu2.js";import"./element-plus-Bescc1QT.js";import"./lodash-es-S0Y0Up6J.js";import"./@vueuse-DfuMZOfy.js";import"./@element-plus-B8yk6LGT.js";import"./@popperjs-D_chPuIy.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BdefatKI.js";import"./artplayer-BnYtXt6g.js";import"./async-validator-9PlIezaS.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-85_40PfK.js";import"./axios-NIGUFBhG.js";import"./vue-cookies-B4eaU0RH.js";import"./@fingerprintjs-BciRmnos.js";import"./tslib-BLN2B0TR.js";import"./vue-cropper-BrUi_TYK.js";import"./mitt-DJ65BbbF.js";import"./moment-C5S46NFB.js";const Y={class:"video-list-panel"},Z={class:"video-title"},ee={class:"detail-panel"},se={class:"video-detail"},oe={class:"count-info"},te={class:"description"},ie={key:1,class:"list-item"},re=["onClick"],ae={key:0,class:"move-handler iconfont icon-move"},ne=["onClick"],le={class:"play-count-info"},de={class:"play-count iconfont icon-play2"},ue={class:"create-time"},ce={__name:"VideoSeriesDetail",setup(pe){const{proxy:s}=T(),g=Q(),u=z(),R=X(),_=j(()=>R.userInfo.userId==u.params.userId),c=y({}),a=y([]),I=async()=>{let t=await s.Request({url:s.Api.uHomeSeriesGetVideoSeriesDetail,params:{seriesId:u.params.seriesId}});t&&(c.value=t.data.videoSeries,a.value=t.data.seriesVideoList,_.value&&a.value.unshift({seriesId:"add"}))};I();const $=async()=>{let t=a.value.map(S=>S.videoId);t.splice(0,1),await s.Request({url:s.Api.uHomeSeriesSaveSeriesVideo,params:{seriesId:u.params.seriesId,videoIds:t.join(",")}})&&s.Message.success("排序成功")},w=t=>{g.push(`/video/${t.videoId}`)},x=t=>{s.Confirm({message:`确定要删除【${t.videoName}】吗？`,okfun:async()=>{await s.Request({url:s.Api.uHomeSeriesDelSeriesVideo,params:{seriesId:u.params.seriesId,videoId:t.videoId}})&&(s.Message.success("删除成功"),I())}})},H=()=>{s.Confirm({message:`确定要删除【${c.value.seriesName}】吗？`,okfun:async()=>{await s.Request({url:s.Api.uHomeSeriesDelVideoSeries,params:{seriesId:u.params.seriesId}})&&(s.Message.success("删除成功"),g.push(`/user/${u.params.userId}/series`))}})},k=y(),M=()=>{k.value.show(c.value,1)},q=()=>{k.value.show(c.value,2)};return(t,e)=>{const S=n("router-link"),A=n("el-divider"),h=n("el-button"),B=n("Cover"),E=n("el-dropdown-item"),L=n("el-dropdown-menu"),U=n("el-dropdown"),b=n("NoData");return l(),p("div",Y,[o("div",Z,[r(S,{to:`/user/${f(u).params.userId}/series`,class:"a-link"},{default:d(()=>e[2]||(e[2]=[v("视频列表",-1)])),_:1,__:[2]},8,["to"]),v(" > "+m(c.value.seriesName),1)]),o("div",ee,[o("div",se,[o("div",oe,[o("div",null,m(a.value.length)+"个视频",1),r(A,{direction:"vertical"}),o("div",null,m(f(s).Utils.formatDate(c.value.updateTime))+"更新",1)]),o("div",te,m(c.value.seriesDescription),1)]),_.value?(l(),p(V,{key:0},[r(h,{type:"primary",onClick:M},{default:d(()=>e[3]||(e[3]=[v("编辑",-1)])),_:1,__:[3]}),r(h,{type:"danger",onClick:H},{default:d(()=>e[4]||(e[4]=[v("删除",-1)])),_:1,__:[4]})],64)):C("",!0)]),r(f(P),{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=i=>a.value=i),onUpdate:$,handle:".move-handler",class:"video-list",draggable:".list-item"},{default:d(()=>[(l(!0),p(V,null,G(a.value,(i,me)=>(l(),p(V,{key:i.seriesId},[i.seriesId=="add"?(l(),p("div",{key:0,class:"video-item-add",onClick:q},e[5]||(e[5]=[o("div",{class:"iconfont icon-add"},null,-1),o("div",{class:"add-info"},"添加视频",-1)]))):(l(),p("div",ie,[o("div",{class:"cover",onClick:D=>w(i)},[_.value?(l(),p("div",ae)):C("",!0),r(B,{source:i.videoCover},null,8,["source"])],8,re),o("div",{class:"list-name",onClick:D=>w(i)},m(i.videoName),9,ne),o("div",le,[o("div",de,m(i.playCount),1),o("div",ue,m(f(s).Utils.formatDate(i.createTime)),1),r(U,null,{dropdown:d(()=>[r(L,null,{default:d(()=>[r(E,{onClick:N(D=>x(i),["stop"])},{default:d(()=>e[6]||(e[6]=[v("删除",-1)])),_:2,__:[6]},1032,["onClick"])]),_:2},1024)]),default:d(()=>[J(o("div",{class:"iconfont icon-more",onClick:e[0]||(e[0]=N(()=>{},["stop"]))},null,512),[[K,_.value]])]),_:2},1024)])]))],64))),128))]),_:1},8,["modelValue"]),a.value.length==0?(l(),F(b,{key:0,msg:"暂无视频"})):C("",!0),r(O,{ref_key:"videoSeriesEditRef",ref:k,onReload:I},null,512)])}}},be=W(ce,[["__scopeId","data-v-186928e2"]]);export{be as default};
