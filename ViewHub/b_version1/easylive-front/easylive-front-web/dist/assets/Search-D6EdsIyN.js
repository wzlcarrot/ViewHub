import{f as L,r as c,i as z,h as K,c as l,o as d,a as e,J as H,O as h,R as O,K as N,P as V,a6 as D,D as $,a4 as A,aj as G,n as U,al as x,Q as C,I as S,M as j,u as E}from"./@vue-_Q8M3GyZ.js";import{a as F,u as J}from"./vue-router-ffDWPyKt.js";import{u as P}from"./navActionStore-DKNJs-en.js";import{_ as R,e as Q}from"./index-V73uJnXy.js";import{d as B}from"./marked-DajSjiQI.js";import"./pinia-CtRA5Bu2.js";import"./element-plus-Bescc1QT.js";import"./lodash-es-S0Y0Up6J.js";import"./@vueuse-DfuMZOfy.js";import"./@element-plus-B8yk6LGT.js";import"./@popperjs-D_chPuIy.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BdefatKI.js";import"./artplayer-BnYtXt6g.js";import"./async-validator-9PlIezaS.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-85_40PfK.js";import"./axios-NIGUFBhG.js";import"./vue-cookies-B4eaU0RH.js";import"./@fingerprintjs-BciRmnos.js";import"./tslib-BLN2B0TR.js";import"./vue-cropper-BrUi_TYK.js";import"./mitt-DJ65BbbF.js";import"./moment-C5S46NFB.js";const W={class:"header-right"},X={class:"minimize-btn"},Y={class:"chatbot-body"},Z={class:"message-avatar"},ee={class:"message-content"},te=["innerHTML"],se={key:0,class:"video-recommendations"},ae=["onClick"],oe={class:"video-title"},re={class:"video-info"},ne={class:"message-time"},ie={key:0,class:"message bot"},le={class:"chatbot-input"},de=["disabled"],ce=["disabled"],ue={__name:"ChatBot",props:{searchKeyword:{type:String,default:""}},setup(q){const{proxy:g}=L(),I=F();B.setOptions({breaks:!0,gfm:!0,headerIds:!1,mangle:!1});const m=q,r=c(!1),u=c(""),n=c(!1),y=c([{type:"bot",text:`ä½ å¥½ï¼æˆ‘æ˜¯å°æ˜“ğŸ¤–ï¼Œä½ çš„æ™ºèƒ½è§†é¢‘åŠ©æ‰‹ã€‚

æˆ‘å¯ä»¥å¸®ä½ ï¼š
â€¢ æ¨èè§†é¢‘
â€¢ è§£ç­”é—®é¢˜
â€¢ èŠå¤©äº’åŠ¨

è¯•è¯•é—®æˆ‘"æ¨èä¸€äº›ç¼–ç¨‹è§†é¢‘"å§ï¼`,timestamp:Date.now()}]),v=c(null),b=()=>{r.value=!r.value},w=t=>t?t>=1e4?(t/1e4).toFixed(1)+"w":t:0,T=t=>new Date(t).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),k=t=>{try{return B.parse(t)}catch(s){return console.error("Markdown è§£æå¤±è´¥:",s),t.replace(/\n/g,"<br>")}},M=t=>{I.push(`/video/${t}`)},i=()=>{U(()=>{v.value&&(v.value.scrollTop=v.value.scrollHeight)})},a=(t,s,o=null)=>{y.value.push({type:t,text:s,videos:o,timestamp:Date.now()}),i()},_=async()=>{if(!u.value.trim()||n.value)return;const t=u.value.trim();a("user",t),u.value="",n.value=!0,i();try{const s=await g.Request({url:g.Api.aiChat,params:{message:t}});n.value=!1,s&&s.data&&s.data.message?a("bot",s.data.message):a("bot","æŠ±æ­‰ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚è¯·ç¨åå†è¯•ã€‚")}catch(s){console.error("AI å¯¹è¯å¤±è´¥:",s),n.value=!1,a("bot",`æŠ±æ­‰ï¼ŒAI æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ğŸ˜…
å¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜æˆ–åç«¯æœåŠ¡æœªå¯åŠ¨ï¼Œè¯·ç¨åå†è¯•ã€‚`)}};return z(()=>m.searchKeyword,t=>{t&&setTimeout(()=>{u.value=`æ¨èå…³äº"${t}"çš„è§†é¢‘`,_()},500)}),K(()=>{i()}),(t,s)=>(d(),l("div",{class:$(["chatbot-container",{minimized:r.value}])},[e("div",{class:"chatbot-header",onClick:b},[s[1]||(s[1]=e("div",{class:"header-left"},[e("span",{class:"bot-icon"},"ğŸ¤–"),e("span",{class:"bot-name"},"å°æ˜“æ™ºèƒ½åŠ©æ‰‹"),e("span",{class:"online-status"},"â— åœ¨çº¿")],-1)),e("div",W,[e("span",X,h(r.value?"â–²":"â–¼"),1)])]),H(e("div",Y,[e("div",{class:"messages-container",ref_key:"messagesContainer",ref:v},[(d(!0),l(V,null,D(y.value,(o,p)=>(d(),l("div",{key:p,class:$(["message",o.type])},[e("div",Z,h(o.type==="bot"?"ğŸ¤–":"ğŸ‘¤"),1),e("div",ee,[e("div",{class:"message-text",innerHTML:k(o.text)},null,8,te),o.videos&&o.videos.length>0?(d(),l("div",se,[(d(!0),l(V,null,D(o.videos,f=>(d(),l("div",{key:f.videoId,class:"video-card",onClick:ge=>M(f.videoId)},[e("div",oe,"ğŸ“¹ "+h(f.videoName),1),e("div",re,[e("span",null,"ğŸ‘ "+h(w(f.playCount)),1),e("span",null,"ğŸ’¬ "+h(w(f.commentCount)),1)])],8,ae))),128))])):N("",!0),e("div",ne,h(T(o.timestamp)),1)])],2))),128)),n.value?(d(),l("div",ie,s[2]||(s[2]=[e("div",{class:"message-avatar"},"ğŸ¤–",-1),e("div",{class:"message-content"},[e("div",{class:"typing-indicator"},[e("span"),e("span"),e("span")])],-1)]))):N("",!0)],512),e("div",le,[H(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>u.value=o),onKeyup:A(_,["enter"]),disabled:n.value,placeholder:"è¾“å…¥æ¶ˆæ¯ï¼Œå’Œæˆ‘èŠå¤©å§...",class:"input-field"},null,40,de),[[G,u.value]]),e("button",{onClick:_,disabled:n.value||!u.value.trim(),class:"send-btn"},h(n.value?"å‘é€ä¸­...":"å‘é€"),9,ce)])],512),[[O,!r.value]])],2))}},pe=R(ue,[["__scopeId","data-v-f8eab642"]]),me={class:"search-body"},ve={class:"search-panel"},_e={class:"order-btns"},he=["onClick"],ye={class:"data-list"},fe={__name:"Search",setup(q){const{proxy:g}=L(),I=F(),m=J(),r=P(),u=Q(),n=c([{name:"ç»¼åˆæ’åº",order:null,orderType:null},{name:"æœ€å¤šæ’­æ”¾",order:"play",orderType:0},{name:"æœ€æ–°å‘å¸ƒ",order:"latest",orderType:1},{name:"æœ€å¤šå¼¹å¹•",order:"danmu",orderType:2},{name:"æœ€å¤šæ”¶è—",order:"collection",orderType:3}]),y=c(m.query.keyword),v=()=>{y.value&&I.push({path:"/search",query:{keyword:y.value,order:b.value}})},b=c(m.query.order),w=i=>{b.value=i.order,v()},T=c(!1),k=c({}),M=async()=>{const i=n.value.find(t=>m.query.order==t.order);let a={pageNo:k.value.pageNo,keyword:m.query.keyword,orderType:i.orderType};T.value=!0;let _=await g.Request({url:g.Api.search,params:a});T.value=!1,_&&(k.value=_.data)};return K(()=>{r.setShowHeader(!1),r.setFixedHeader(!1),r.setFixedCategory(!1),r.setShowCategory(!1),r.setForceFixedHeader(!0)}),z(()=>m.query.keyword,(i,a)=>{i&&(M(),u.addHistory(i))},{immediate:!0,deep:!0}),(i,a)=>{const _=x("el-button"),t=x("el-input"),s=x("VideoItem"),o=x("DataGridList");return d(),l("div",me,[e("div",ve,[C(t,{placeholder:"è¯·è¾“å…¥å…³é”®å­—",modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=p=>y.value=p),size:"large",onKeyup:A(v,["enter"])},{prefix:S(()=>a[1]||(a[1]=[e("span",{class:"iconfont icon-search"},null,-1)])),suffix:S(()=>[C(_,{type:"primary",onClick:v,class:"search-btn"},{default:S(()=>a[2]||(a[2]=[j("æœç´¢",-1)])),_:1,__:[2]})]),_:1},8,["modelValue"])]),e("div",_e,[(d(!0),l(V,null,D(n.value,p=>(d(),l("div",{class:$(["btn",b.value==p.order?"active":""]),onClick:f=>w(p)},h(p.name),11,he))),256))]),e("div",ye,[C(o,{gridCount:6,dataSource:k.value},{default:S(({data:p})=>[C(s,{data:p},null,8,["data"])]),_:1},8,["dataSource"])]),C(pe,{searchKeyword:E(m).query.keyword},null,8,["searchKeyword"])])}}},je=R(fe,[["__scopeId","data-v-27ee170f"]]);export{je as default};
