import{a as H}from"./vue-router-ffDWPyKt.js";import{u as N}from"./navActionStore-DKNJs-en.js";import{_ as w}from"./index-V73uJnXy.js";import{f as x,r as v,h as L,al as r,c as S,o as A,a as o,Q as l,I as u,M as I,u as M,O as b}from"./@vue-_Q8M3GyZ.js";import"./pinia-CtRA5Bu2.js";import"./element-plus-Bescc1QT.js";import"./lodash-es-S0Y0Up6J.js";import"./@vueuse-DfuMZOfy.js";import"./@element-plus-B8yk6LGT.js";import"./@popperjs-D_chPuIy.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BdefatKI.js";import"./artplayer-BnYtXt6g.js";import"./async-validator-9PlIezaS.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-85_40PfK.js";import"./axios-NIGUFBhG.js";import"./vue-cookies-B4eaU0RH.js";import"./@fingerprintjs-BciRmnos.js";import"./tslib-BLN2B0TR.js";import"./vue-cropper-BrUi_TYK.js";import"./mitt-DJ65BbbF.js";import"./moment-C5S46NFB.js";const R={class:"history-list"},$={class:"top-info"},q={class:"data-list"},B={class:"history-item"},T=["onClick"],V={class:"video-info"},F=["onClick"],O={class:"op-btns"},U=["onClick"],j={__name:"History",setup(E){const{proxy:t}=x(),f=H(),c=N(),d=v(!1),i=v({}),m=async()=>{let s={pageNo:i.value.pageNo};d.value=!0;let e=await t.Request({url:t.Api.playHisotry,params:s});if(d.value=!1,!e)return;const n=i.value.list;i.value=Object.assign({},e.data),e.data.pageNo>1&&(i.value.list=n.concat(e.data.list))};m(),L(()=>{c.setShowHeader(!0),c.setFixedHeader(!0),c.setFixedCategory(!1),c.setShowCategory(!1)});const y=()=>{t.Confirm({message:"确定要清空历史记录吗？",okfun:async()=>{await t.Request({url:t.Api.cleanHistory})&&(t.Message.success("删除成功"),i.value={list:[]})}})},g=s=>{t.Confirm({message:"确定要删除记录吗？",okfun:async()=>{await t.Request({url:t.Api.delHistory,params:{videoId:s}})&&(t.Message.success("删除成功"),i.value.list=i.value.list.filter(n=>n.videoId!=s))}})},p=s=>{f.push(`/video/${s}`)};return(s,e)=>{const n=r("el-button"),C=r("Cover"),h=r("el-timeline-item"),k=r("DataLoadMoreList"),D=r("el-timeline");return A(),S("div",R,[o("div",$,[e[1]||(e[1]=o("div",{class:"iconfont icon-wating"},"历史记录",-1)),o("div",null,[l(n,{type:"primary",onClick:y},{default:u(()=>e[0]||(e[0]=[I("清空历史",-1)])),_:1,__:[0]})])]),l(D,null,{default:u(()=>[o("div",q,[l(k,{dataSource:i.value,loading:d.value,onLoadData:m,layoutType:"line"},{default:u(({data:a})=>[l(h,{timestamp:M(t).Utils.formatDate(a.lastUpdateTime),placement:"top"},{default:u(()=>[o("div",B,[o("div",{class:"cover",onClick:_=>p(a.videoId)},[l(C,{source:a.videoCover},null,8,["source"])],8,T),o("div",V,[o("div",{onClick:_=>p(a.videoId)},b(a.videoName||s.已失效视频),9,F)]),o("div",O,[o("div",{class:"iconfont icon-delete",onClick:_=>g(a.videoId)},null,8,U)])])]),_:2},1032,["timestamp"])]),_:1},8,["dataSource","loading"])])]),_:1})])}}},_t=w(j,[["__scopeId","data-v-73eedb58"]]);export{_t as default};
