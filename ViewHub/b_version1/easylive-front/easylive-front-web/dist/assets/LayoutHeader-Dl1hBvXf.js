import{f as W,r as h,l as X,h as Y,S as Z,al as p,c as a,o as l,a as t,Q as c,I as r,P as C,a6 as L,u as o,H as N,O as u,M as z,K as S,V as ee,D as B,J as te,aj as se,a4 as oe}from"./@vue-_Q8M3GyZ.js";import{_ as ne,a as le,u as ae,e as ie,m as K}from"./index-V73uJnXy.js";import{u as re,a as ue}from"./vue-router-ffDWPyKt.js";const ce={class:"menu"},de={class:"nav-list"},ve={class:"nav-part"},fe={class:"category-name"},pe={class:"search-body"},me={class:"search-panel-inner"},ge=["placeholder"],ye={key:0,class:"history-panel"},_e={class:"search-title"},he={class:"search-tag-list"},Ce={class:"hot-search-list"},ke=["onClick"],Ie={class:"user-panel"},we={class:"user-avatar"},Le={class:"user-info-panel"},Se={class:"nick-name"},be={class:"count-info"},He={class:"count-info-item"},$e={class:"count-value"},Ne={class:"count-info-item"},Re={class:"count-value"},Ve={class:"count-info-item"},xe={class:"count-value"},Me={class:"btn-upload"},b=5,Ae={__name:"LayoutHeader",props:{theme:{type:String,default:"light"},hotSearchList:{type:Array,default:[]}},setup(R){const{proxy:d}=W(),D=re(),V=ue(),n=le(),x=ae(),H=ie(),k=h({}),E=async()=>{let i=await d.Request({url:d.Api.getUserCountInfo});i&&(k.value=i.data)},M=X(()=>Math.ceil(x.categoryList.length/b)),F=()=>{if(!n.isLoggedIn){n.setLogin(!0);return}},A=h("请输入搜索关键词"),m=h(),U=i=>{V.push({path:"/search",query:{keyword:i}})},J=()=>{m.value||(m.value=A.value),V.push({path:"/search",query:{keyword:m.value}})},I=d.Utils.debounce(J,300),v=h(!1),P=()=>{v.value=!0},$=h();let g=null,y=null;Y(()=>{g=()=>{v.value=!1},document.addEventListener("click",g),y=()=>{v.value&&($.value&&$.value.blur(),v.value=!1)},K.on("windowScroll",y)}),Z(()=>{g&&(document.removeEventListener("click",g),g=null),y&&(K.off("windowScroll",y),y=null)});const _=i=>{if(!n.isLoggedIn){n.setLogin(!0);return}window.open(i,"_blank")},T=()=>{d.Confirm({message:"确定要退出?",okfun:async()=>{await d.Request({url:d.Api.logout})&&n.saveUserInfo({})}})};return(i,e)=>{const w=p("router-link"),j=p("el-popover"),O=p("el-tag"),q=p("Avatar"),Q=p("el-badge"),G=p("el-button");return l(),a("div",{class:B(["header-bar","header-bar-"+R.theme])},[t("div",ce,[c(j,{width:M.value*171+24,trigger:"hover","show-arrow":!1,offset:22,placement:"bottom-start"},{reference:r(()=>[c(w,{class:"iconfont icon-logo menu-item",to:"/"},{default:r(()=>e[10]||(e[10]=[z("首页",-1)])),_:1,__:[10]})]),default:r(()=>[t("div",de,[(l(!0),a(C,null,L(M.value,s=>(l(),a("div",ve,[(l(!0),a(C,null,L(o(x).categoryList.slice((s-1)*b,(s-1)*b+b),f=>(l(),N(w,{class:"nav-item",to:`/v/${f.categoryCode}`},{default:r(()=>[t("span",fe,u(f.categoryName),1)]),_:2},1032,["to"]))),256))]))),256))])]),_:1},8,["width"])]),t("div",pe,[o(D).path!="/search"?(l(),a("div",{key:0,class:"search-panel",onClick:e[4]||(e[4]=ee(()=>{},["stop"]))},[t("div",me,[t("div",{class:B(["input-panel",v.value?"focus-input":""])},[te(t("input",{onFocus:P,"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),ref_key:"searchInputRef",ref:$,placeholder:A.value,onKeyup:e[1]||(e[1]=oe((...s)=>o(I)&&o(I)(...s),["enter"]))},null,40,ge),[[se,m.value]]),t("div",{class:"iconfont icon-search",onClick:e[2]||(e[2]=(...s)=>o(I)&&o(I)(...s))})],2),v.value?(l(),a("div",ye,[t("div",_e,[e[11]||(e[11]=t("div",{class:"title"},"搜索历史",-1)),t("div",{class:"btn-clean",onClick:e[3]||(e[3]=s=>o(H).cleanHistory())}," 清空 ")]),t("div",he,[(l(!0),a(C,null,L(o(H).searchHistory,s=>(l(),N(O,{key:s.name,closable:"",type:"info",class:"search-tag",onClick:f=>U(s),onClose:f=>o(H).delHistory(s)},{default:r(()=>[z(u(s),1)]),_:2},1032,["onClick","onClose"]))),128))]),e[12]||(e[12]=t("div",{class:"hot-search-title"},"热搜",-1)),t("div",Ce,[(l(!0),a(C,null,L(R.hotSearchList,(s,f)=>(l(),a("div",{class:"search-item",onClick:Ue=>U(s)},u(f+1)+" "+u(s),9,ke))),256))])])):S("",!0)])])):S("",!0)]),t("div",Ie,[t("div",we,[o(n).isLoggedIn?(l(),a(C,{key:0},[c(q,{class:"avatar",avatar:o(n).userInfo.avatar,userId:o(n).userInfo.userId,width:35,lazy:!1,onMouseover:E},null,8,["avatar","userId"]),t("div",Le,[t("div",Se,u(o(n).userInfo.nickName),1),t("div",be,[t("div",He,[t("div",$e,u(k.value.focusCount),1),e[13]||(e[13]=t("div",{class:"count-title"},"关注",-1))]),t("div",Ne,[t("div",Re,u(k.value.fansCount),1),e[14]||(e[14]=t("div",{class:"count-title"},"粉丝",-1))]),t("div",Ve,[t("div",xe,u(k.value.currentCoinCount),1),e[15]||(e[15]=t("div",{class:"count-title"},"硬币",-1))])]),c(w,{to:`/user/${o(n).userInfo.userId}`,class:"item iconfont icon-user"},{default:r(()=>e[16]||(e[16]=[t("span",{class:"item-name"},"个人中心",-1),t("span",{class:"iconfont icon-left"},null,-1)])),_:1,__:[16]},8,["to"]),c(w,{to:"/ucenter/video",class:"item iconfont icon-play"},{default:r(()=>e[17]||(e[17]=[t("span",{class:"item-name"},"投稿管理",-1),t("span",{class:"iconfont icon-left"},null,-1)])),_:1,__:[17]}),t("div",{class:"logout item iconfont icon-logout",onClick:T}," 退出登录 ")])],64)):S("",!0),o(n).isLoggedIn?S("",!0):(l(),N(q,{key:1,onClick:F,width:35,lazy:!1}))]),t("div",{class:"user-panel-item",onClick:e[5]||(e[5]=s=>_("/message"))},[c(Q,{value:o(n).messageNoReadCount,hidden:o(n).messageNoReadCount==0},{default:r(()=>e[18]||(e[18]=[t("div",{class:"iconfont icon-message"},null,-1)])),_:1,__:[18]},8,["value","hidden"]),e[19]||(e[19]=t("div",null,"消息",-1))]),t("div",{class:"user-panel-item",onClick:e[6]||(e[6]=s=>_(`/user/${o(n).userInfo.userId}/collection`))},e[20]||(e[20]=[t("div",{class:"iconfont icon-collection"},null,-1),t("div",null,"收藏",-1)])),t("div",{class:"user-panel-item",onClick:e[7]||(e[7]=s=>_("/history"))},e[21]||(e[21]=[t("div",{class:"iconfont icon-history"},null,-1),t("div",null,"历史",-1)])),t("div",{class:"user-panel-item",onClick:e[8]||(e[8]=s=>_("/ucenter/home"))},e[22]||(e[22]=[t("div",{class:"iconfont icon-light"},null,-1),t("div",null,"创作中心",-1)])),t("div",Me,[c(G,{type:"primary",onClick:e[9]||(e[9]=s=>_("/ucenter/postVideo")),size:"large"},{default:r(()=>e[23]||(e[23]=[t("span",{class:"iconfont icon-upload"},null,-1),t("span",null,"投稿",-1)])),_:1,__:[23]})])])],2)}}},Ke=ne(Ae,[["__scopeId","data-v-41993f57"]]);export{Ke as L};
